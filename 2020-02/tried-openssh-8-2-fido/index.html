<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Gridsome - Gridsome</title><meta name="gridsome:hash" content="a89a72b64405c66920c43e61d16ebed104e600c8"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.12"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/gridsome-blog/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/gridsome-blog/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/gridsome-blog/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/gridsome-blog/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/gridsome-blog/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/gridsome-blog/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/gridsome-blog/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/gridsome-blog/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/gridsome-blog/assets/css/0.styles.adc66d7f.css" as="style"><link rel="preload" href="/gridsome-blog/assets/js/app.f79019ea.js" as="script"><link rel="preload" href="/gridsome-blog/assets/js/page--src--templates--post-vue.307a28fc.js" as="script"><link rel="prefetch" href="/gridsome-blog/assets/js/page--node-modules--gridsome--app--pages--404-vue.63d4caf9.js"><link rel="prefetch" href="/gridsome-blog/assets/js/page--src--pages--index-vue.83741925.js"><link rel="stylesheet" href="/gridsome-blog/assets/css/0.styles.adc66d7f.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout"><header class="header"><strong><a href="/gridsome-blog/" class="active">Gridsome</a></strong><nav class="nav"><a href="/gridsome-blog/" class="nav__link active">Home</a></nav></header><div class="post-title"><h1>OpenSSH8.2でFIDO2を試しました</h1><p class="post-date"> 18 February 2020 | 1 min read</p></div><div class="post-content"><p><p>といってもキーの生成だけですが……</p>
<p>とりあえず手元にある古い(？) Yubikey を使って ecdsa-sk のキーの生成ができることを確認してみます。</p>
<pre class="language-shell"><code class="language-shell">$ ssh-keygen -t ecdsa-sk -b <span class="token number">521</span>
Generating public/private ecdsa-sk key pair.
You may need to <span class="token function">touch</span> your authenticator to authorize key generation.
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>: 
Enter same passphrase again: 
Your identification has been saved <span class="token keyword">in</span> <span class="token punctuation">..</span>.
Your public key has been saved <span class="token keyword">in</span> <span class="token punctuation">..</span>.
The key fingerprint is:
SHA256:LHym5H0zQ6tvRXNZp/bMEUy7F1WN6tUicAGJMjxSOZQ <span class="token punctuation">..</span>.
The key's randomart image is:
+-<span class="token punctuation">[</span>ECDSA-SK <span class="token number">256</span><span class="token punctuation">]</span>--+
<span class="token operator">|</span>     +oo <span class="token punctuation">..</span>o<span class="token punctuation">..</span>oo<span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>    <span class="token builtin class-name">.</span> E <span class="token builtin class-name">.</span> o <span class="token builtin class-name">.</span> .o*<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token builtin class-name">.</span> <span class="token operator">=</span>   o <span class="token builtin class-name">.</span> Bo<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>    <span class="token operator">=</span> B.+<span class="token operator">|</span>
<span class="token operator">|</span>      + S .o * *o<span class="token operator">|</span>
<span class="token operator">|</span>     o * <span class="token builtin class-name">.</span> .o   <span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>      o <span class="token builtin class-name">.</span> *.     <span class="token operator">|</span>
<span class="token operator">|</span>         o.+     <span class="token operator">|</span>
<span class="token operator">|</span>        .o.      <span class="token operator">|</span>
+----<span class="token punctuation">[</span>SHA256<span class="token punctuation">]</span>-----+</code></pre>
<p>256 bit になってしまいました、 Yubikey 側の制限ですかね？</p>
<p>念のため？ ed25519-sk のキーも生成してみます。</p>
<pre class="language-shell"><code class="language-shell">$ ssh-keygen -t ed25519-sk -b <span class="token number">521</span>
Generating public/private ed25519-sk key pair.
You may need to <span class="token function">touch</span> your authenticator to authorize key generation.
Key enrollment failed: requested feature not supported</code></pre>
<p>Yubikey が ed25519 に対応していないのでこちらは当然失敗しました。</p>
<p>生成に成功した ecdsa-sk キーを使って ssh しようとしてみましたが、相手が openssh7.9p1 だったので失敗しました。</p>
<p>とはいえ Yubikey の SmartCard の方が〜〜〜、というか対応サーバーが十分普及したら使うか考えましょう。</p>
<p>リリースノート、FIDO2/U2F と書いている部分と FIDO2 しか書いていない部分があって、 U2F しか書いていない部分はない？ので、
U2F についてはよく分かっていません……というか、認証周りいろいろややこしすぎて……追い追い調べてまとめようと思います。</p>
</p></div><div class="footer"><p>
      Built with
      <a href="//gridsome.org" class="link">Gridsome</a></p></div></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"id":"f181f388fbe37b57704d129ba47812f4","title":"OpenSSH8.2でFIDO2を試しました","content":"\u003Cp\u003Eといってもキーの生成だけですが……\u003C\u002Fp\u003E\n\u003Cp\u003Eとりあえず手元にある古い(？) Yubikey を使って ecdsa-sk のキーの生成ができることを確認してみます。\u003C\u002Fp\u003E\n\u003Cpre class=\"language-shell\"\u003E\u003Ccode class=\"language-shell\"\u003E$ ssh-keygen -t ecdsa-sk -b \u003Cspan class=\"token number\"\u003E521\u003C\u002Fspan\u003E\nGenerating public\u002Fprivate ecdsa-sk key pair.\nYou may need to \u003Cspan class=\"token function\"\u003Etouch\u003C\u002Fspan\u003E your authenticator to authorize key generation.\nEnter passphrase \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eempty \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E no passphrase\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E: \nEnter same passphrase again: \nYour identification has been saved \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E.\nYour public key has been saved \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E.\nThe key fingerprint is:\nSHA256:LHym5H0zQ6tvRXNZp\u002FbMEUy7F1WN6tUicAGJMjxSOZQ \u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E.\nThe key's randomart image is:\n+-\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003EECDSA-SK \u003Cspan class=\"token number\"\u003E256\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E--+\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E     +oo \u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003Eo\u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003Eoo\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E    \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E E \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E o \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E .o*\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E     \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E   o \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E Bo\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E     \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E    \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E B.+\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E      + S .o * *o\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E     o * \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E .o   \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E      o \u003Cspan class=\"token builtin class-name\"\u003E.\u003C\u002Fspan\u003E *.     \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E         o.+     \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E        .o.      \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E\n+----\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESHA256\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E-----+\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E256 bit になってしまいました、 Yubikey 側の制限ですかね？\u003C\u002Fp\u003E\n\u003Cp\u003E念のため？ ed25519-sk のキーも生成してみます。\u003C\u002Fp\u003E\n\u003Cpre class=\"language-shell\"\u003E\u003Ccode class=\"language-shell\"\u003E$ ssh-keygen -t ed25519-sk -b \u003Cspan class=\"token number\"\u003E521\u003C\u002Fspan\u003E\nGenerating public\u002Fprivate ed25519-sk key pair.\nYou may need to \u003Cspan class=\"token function\"\u003Etouch\u003C\u002Fspan\u003E your authenticator to authorize key generation.\nKey enrollment failed: requested feature not supported\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EYubikey が ed25519 に対応していないのでこちらは当然失敗しました。\u003C\u002Fp\u003E\n\u003Cp\u003E生成に成功した ecdsa-sk キーを使って ssh しようとしてみましたが、相手が openssh7.9p1 だったので失敗しました。\u003C\u002Fp\u003E\n\u003Cp\u003Eとはいえ Yubikey の SmartCard の方が〜〜〜、というか対応サーバーが十分普及したら使うか考えましょう。\u003C\u002Fp\u003E\n\u003Cp\u003Eリリースノート、FIDO2\u002FU2F と書いている部分と FIDO2 しか書いていない部分があって、 U2F しか書いていない部分はない？ので、\nU2F についてはよく分かっていません……というか、認証周りいろいろややこしすぎて……追い追い調べてまとめようと思います。\u003C\u002Fp\u003E\n","date":"18 February 2020","timeToRead":1}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/gridsome-blog/assets/js/app.f79019ea.js" defer></script><script src="/gridsome-blog/assets/js/page--src--templates--post-vue.307a28fc.js" defer></script>
  </body>
</html>
