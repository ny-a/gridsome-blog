<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Gridsome - Gridsome</title><meta name="gridsome:hash" content="a89a72b64405c66920c43e61d16ebed104e600c8"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.12"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/gridsome-blog/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/gridsome-blog/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/gridsome-blog/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/gridsome-blog/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/gridsome-blog/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/gridsome-blog/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/gridsome-blog/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/gridsome-blog/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/gridsome-blog/assets/css/0.styles.adc66d7f.css" as="style"><link rel="preload" href="/gridsome-blog/assets/js/app.f79019ea.js" as="script"><link rel="preload" href="/gridsome-blog/assets/js/page--src--templates--post-vue.307a28fc.js" as="script"><link rel="prefetch" href="/gridsome-blog/assets/js/page--node-modules--gridsome--app--pages--404-vue.63d4caf9.js"><link rel="prefetch" href="/gridsome-blog/assets/js/page--src--pages--index-vue.83741925.js"><link rel="stylesheet" href="/gridsome-blog/assets/css/0.styles.adc66d7f.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout"><header class="header"><strong><a href="/gridsome-blog/" class="active">Gridsome</a></strong><nav class="nav"><a href="/gridsome-blog/" class="nav__link active">Home</a></nav></header><div class="post-title"><h1>DNSSECの設定をしました</h1><p class="post-date"> 27 February 2020 | 1 min read</p></div><div class="post-content"><p><p>クライアント側もドメイン側も、設定するだけで DNSSEC が使える状態になっていたので、両方とも設定して
DNSSEC を有効にしてみました。</p>
<h2 id="クライアント設定"><a href="#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A" aria-hidden="true"><span class="icon icon-link"></span></a>クライアント設定</h2>
<p>DNS リゾルバは <code>systemd-resolved</code> を使っているので、 DNSSEC 対応の DNS サーバーが使われていれば DNSSEC が有効になります。
<code>1.1.1.1</code> や <code>8.8.8.8</code> は DNSSEC に対応しています。
しかし、ルーターなどが提供するリゾルバは対応していないことが多いので、それをデフォルトで使っていて無効になっていました。
<code>1.1.1.1</code> を直接使うように設定するには、 <code>/etc/systemd/resolved.conf</code> に以下の行を追加します。</p>
<p><code>DNS=1.1.1.1</code></p>
<p>あとは <code>sudo systemctl restart systemd-resolve</code> を実行して、 <code>systemd-resolved</code> サービスを再起動すれば有効になります。</p>
<p>有効になっていれば、 <code>resolvectl query sigfail.verteiltesysteme.net</code> を実行すると <code>invalid</code> とエラーが出るはずです。</p>
<h2 id="ドメインの設定"><a href="#%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%81%AE%E8%A8%AD%E5%AE%9A" aria-hidden="true"><span class="icon icon-link"></span></a>ドメインの設定</h2>
<p><a href="https://hnw.hatenablog.com/entry/20160321" target="_blank" rel="nofollow noopener noreferrer">DNSSEC対応の独自ドメインを年額$0.88で運用できるよという話</a>
を見ると、海外のレジストラは DNSSEC に対応しているところが多いようです。
私の使っている <code>nyaw.dev</code> は Gandi で取得したため、ボタン1つで有効化することができました。</p>
<p><a href="https://dnsviz.net/d/nyaw.dev/dnssec/" target="_blank" rel="nofollow noopener noreferrer">nyaw.dev - dnsviz</a>
を確認すると、正常に設定されていることが確認できます。</p>
<p>といっても、リダイレクトさせているのであんまり嬉しくはないんですが……。</p>
<p>ブログだけではなくポートフォリオも含めてページを充実させていって、ドメイン設定もきちんとしていこうと思っています。</p>
</p></div><div class="footer"><p>
      Built with
      <a href="//gridsome.org" class="link">Gridsome</a></p></div></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"id":"1fb6189ddec72a736b416e5aa70caa10","title":"DNSSECの設定をしました","content":"\u003Cp\u003Eクライアント側もドメイン側も、設定するだけで DNSSEC が使える状態になっていたので、両方とも設定して\nDNSSEC を有効にしてみました。\u003C\u002Fp\u003E\n\u003Ch2 id=\"クライアント設定\"\u003E\u003Ca href=\"#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Eクライアント設定\u003C\u002Fh2\u003E\n\u003Cp\u003EDNS リゾルバは \u003Ccode\u003Esystemd-resolved\u003C\u002Fcode\u003E を使っているので、 DNSSEC 対応の DNS サーバーが使われていれば DNSSEC が有効になります。\n\u003Ccode\u003E1.1.1.1\u003C\u002Fcode\u003E や \u003Ccode\u003E8.8.8.8\u003C\u002Fcode\u003E は DNSSEC に対応しています。\nしかし、ルーターなどが提供するリゾルバは対応していないことが多いので、それをデフォルトで使っていて無効になっていました。\n\u003Ccode\u003E1.1.1.1\u003C\u002Fcode\u003E を直接使うように設定するには、 \u003Ccode\u003E\u002Fetc\u002Fsystemd\u002Fresolved.conf\u003C\u002Fcode\u003E に以下の行を追加します。\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode\u003EDNS=1.1.1.1\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Eあとは \u003Ccode\u003Esudo systemctl restart systemd-resolve\u003C\u002Fcode\u003E を実行して、 \u003Ccode\u003Esystemd-resolved\u003C\u002Fcode\u003E サービスを再起動すれば有効になります。\u003C\u002Fp\u003E\n\u003Cp\u003E有効になっていれば、 \u003Ccode\u003Eresolvectl query sigfail.verteiltesysteme.net\u003C\u002Fcode\u003E を実行すると \u003Ccode\u003Einvalid\u003C\u002Fcode\u003E とエラーが出るはずです。\u003C\u002Fp\u003E\n\u003Ch2 id=\"ドメインの設定\"\u003E\u003Ca href=\"#%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Eドメインの設定\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhnw.hatenablog.com\u002Fentry\u002F20160321\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EDNSSEC対応の独自ドメインを年額$0.88で運用できるよという話\u003C\u002Fa\u003E\nを見ると、海外のレジストラは DNSSEC に対応しているところが多いようです。\n私の使っている \u003Ccode\u003Enyaw.dev\u003C\u002Fcode\u003E は Gandi で取得したため、ボタン1つで有効化することができました。\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fdnsviz.net\u002Fd\u002Fnyaw.dev\u002Fdnssec\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Enyaw.dev - dnsviz\u003C\u002Fa\u003E\nを確認すると、正常に設定されていることが確認できます。\u003C\u002Fp\u003E\n\u003Cp\u003Eといっても、リダイレクトさせているのであんまり嬉しくはないんですが……。\u003C\u002Fp\u003E\n\u003Cp\u003Eブログだけではなくポートフォリオも含めてページを充実させていって、ドメイン設定もきちんとしていこうと思っています。\u003C\u002Fp\u003E\n","date":"27 February 2020","timeToRead":1}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/gridsome-blog/assets/js/app.f79019ea.js" defer></script><script src="/gridsome-blog/assets/js/page--src--templates--post-vue.307a28fc.js" defer></script>
  </body>
</html>
