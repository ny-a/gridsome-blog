{"hash":"5cd4ee6713c3e4aa78ca4ae8cf680a0b79ce2dc7","data":{"post":{"id":"1786f8fee65a6fa46dfffdd54a8de0e3","title":"TsukuCTF2021 Writeup(OSINT以外)","content":"<p><a href=\"https://tsukuctf.sechack365.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">TsukuCTF</a></p>\n<p>ny_a です。182チーム中5位でした。</p>\n<h2 id=\"web\"><a href=\"#web\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Web</h2>\n<h3 id=\"logonly\"><a href=\"#logonly\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Logonly</h3>\n<p>解けませんでした。</p>\n<p>デカいログを見てみると、214154行目に攻撃が成功しているという情報しかありませんでした。</p>\n<p>Kali Linux は使ったことないな〜、ダウンロードも面倒だし、と思いググってみると、\n<a href=\"https://gitlab.com/kalilinux/packages/wordlists\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">kalilinux/wordlists</a> リポジトリに\nrockyou というパスワードリストがあるようでした。サイズも十分大きいし、最終更新も8年前なのでバージョンの問題もなさそうです。\nungzip して214154行目の <code>qwertzu</code> で incorrect。別ファイルかなーと思い諦めました。</p>\n<p>ちなみに、作問者さんに聞いてみた所想定解法っぽいですね。1つ古い？バージョンだと <code>/dev/null</code> が入っていないらしいです。なるほど。</p>\n<p>guess 問題なのでエスパーすればよかったですね。</p>\n<h3 id=\"digits\"><a href=\"#digits\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>digits</h3>\n<p>python の <code>int()</code> が int を返せば ok そうです。\nドキュメントを見るとアンダースコアを任意の位置に入れることができるようです。</p>\n<p><code>1_1_1111111</code></p>\n<h3 id=\"login\"><a href=\"#login\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Login</h3>\n<p>SQLi ですか。普通にフレームワークを使ってバックエンドの開発をやっていると、そのような脆弱性を作り込むこともほぼないので、\n攻撃方法についてはあまり詳しくなく……。調べながらクエリを投げたらログインできました。</p>\n<h3 id=\"login2-login3\"><a href=\"#login2-login3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Login2, Login3</h3>\n<p>解けませんでした。</p>\n<p>同じようにログインはできましたが、あんまり攻撃するのも申し訳なくなってきたので諦めました。\nバックエンドエンジニアにこんなことさせないで……と思いましたが、次までには解けるように練習しておきます。</p>\n<h3 id=\"journey\"><a href=\"#journey\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Journey</h3>\n<p>HTTP ステータスコードを見ろと言われたので見ると、Method not allowed。</p>\n<p>OPTIONS の返答から一つずつ試していくと、CONNECT で referrer 関連のエラーメッセージが出ます。</p>\n<p><code>curl -XCONNECT --referrer (railwaysのURL)</code> とかするとフラグが得られます。</p>\n<h3 id=\"gyotaku\"><a href=\"#gyotaku\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>gyOTAKU</h3>\n<p>解けませんでした。</p>\n<p>適当にローカルファイルを iframe に表示する HTML を書いて、適当に GitHub Pages にデプロイしてみたものの、キャッシュの問題か404……。\n適当にローカルに nginx コンテナでサーバーを建ててみたものの、ディレクトリ一覧はなぜか表示されず。</p>\n<p><code>/etc/passwd</code> とか見るのもかわいそう(？)だと思い試しませんでしたが、試していたら解けていたかもしれません。\nいやだからあんまり攻撃させないでください…………。</p>\n<h2 id=\"rev\"><a href=\"#rev\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Rev</h2>\n<h3 id=\"legacy-code\"><a href=\"#legacy-code\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Legacy code</h3>\n<p>pentium と書かれている所は x87 FPU の命令っぽいですね。</p>\n<p>800.635 + 0.365 をしているようです。ちょうど801くらいになりますね。</p>\n<p>それを <code>PC%d%.0f</code> で表示しているようです。多分 <code>PC9801</code> でしょう。試したら通りました。</p>\n<p>$9 って即値なんですね。知りませんでした。</p>\n<h2 id=\"network\"><a href=\"#network\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Network</h2>\n<h3 id=\"genesis\"><a href=\"#genesis\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Genesis</h3>\n<p>ブロックチェーンの知識はないですが、データ構造を見ながら前や後を見ていくと、GENESIS と書かれたものを発見。</p>\n<p>その tx から、\n<code>/api/getrawtransaction?txid=f44d8ca0b6e787c2193297aec523d685bc0ab5a38eca5a0b014c5a679507b13e&#x26;decrypt=1</code>\nにアクセスして、適当に hex を ascii に変換してみたらフラグがありました。</p>\n<h2 id=\"crypt\"><a href=\"#crypt\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Crypt</h2>\n<h3 id=\"crackssh\"><a href=\"#crackssh\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>CrackSSH!</h3>\n<p>適当に e と n を見てみると、e がデカいのが脆弱なようです。</p>\n<p>適当に d を調べて、適当に rsatool で秘密鍵を作ると、ログインが……できません。</p>\n<p>多分 ssh-agent が悪いんでしょう。適当に docker コンテナ内から ssh すると入れました。</p>\n<p><code>flag.txt</code> ファイルにフラグが書いてありました。</p>\n<h2 id=\"misc\"><a href=\"#misc\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Misc</h2>\n<h3 id=\"toritsukushi\"><a href=\"#toritsukushi\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>TORitsukushi</h3>\n<p>VSCodeで開いて適当に s/TSUKUSHI//g な置換をしまくったら、case insensitive になっていたようで incorrect。\ncase sensitive にしてやり直しました。</p>\n<h3 id=\"customization\"><a href=\"#customization\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Customization</h3>\n<p>マンダラートは何か分かりませんでしたが、目標とか書いてあるので9x9のあのなんか、あれでしょうか。\n真ん中に目標書いてありそうですよね。背景色が変わっていますが、数式バーには出るので見るだけです。</p>\n<h3 id=\"discriminate\"><a href=\"#discriminate\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>discriminate</h3>\n<p>あー、途中まで見覚えのある文章ですね……。\nとりあえず内容が破綻し始める位置のあたりをつけて、ポスターと完全一致している所の末尾5文字を投げてみます。\nそれでダメだったらモデルを動かして……と思ったのですが、通ったのでヨシ！</p>\n<h2 id=\"hardware\"><a href=\"#hardware\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Hardware</h2>\n<h3 id=\"cad\"><a href=\"#cad\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>CAD</h3>\n<p>ご丁寧にも CAD ソフトいらないよと書いてあるので stl online viewer とかでググって適当に開きます。\n左右の {} が微妙に違っていて、tかな……？とかやって incorrect になってしまいました。\nCTF 初心者なのでフラグ形式でピンと来ず……。</p>\n<h3 id=\"ltika\"><a href=\"#ltika\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Ltika</h3>\n<p>Arduino ですね。丁寧に関数を作って点滅させているようです。\n関数名だけ無視して、長いのと短いのがあるのでモールス信号だろうと推測、適当なサイトで復号(？)しました。</p>\n<h3 id=\"pcb\"><a href=\"#pcb\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>PCB</h3>\n<p>なんかオンラインのガーバービューアーだと丸い基板みたいな感じに表示されてしまった？ので、\n最近はあまり出番のない KiCad を起動して開きます。</p>\n<p>そもそも LED と POWER の区別すらしないで適当に星座と見比べていたらそれっぽいのを見つけたので投げてみました。</p>\n<h2 id=\"tsukushi\"><a href=\"#tsukushi\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tsukushi</h2>\n<h3 id=\"welcome\"><a href=\"#welcome\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Welcome</h3>\n<p>補足にスクリーンネームでいいよって書いてあったのでそちらで。\n終わった後にアカウント見たら、ユーザー名がフラグ形式になっていたのでこちらが想定解だったんだなと気付きました。</p>\n<h2 id=\"感想\"><a href=\"#%E6%84%9F%E6%83%B3\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>感想</h2>\n<p>CTF、多分期間の決まっていて一般公開されているものに出るのは初めて？な気がするのですが、出てみるもんですね。楽しかったです。</p>\n<p>(上記に該当しないものとして、CpawCTF と、セキュキャンの講義内で CTF 形式の演習はやったことがあります。その程度で、マジの初心者です。いやこれはマジなんですよ。信じて。)</p>\n<p>サービスを守るには攻撃手法の概要くらいを知っていればいいか……と思っていたのですが、\n具体的な攻撃手法を知ることも大事なのかなと考え直しました。勉強します。</p>\n<p>とはいえ、fork bomb で怒られてしまう国ではなかなか難しい気もしないでもないんですよね……。</p>\n","date":"15 September 2021","timeToRead":1}},"context":{}}