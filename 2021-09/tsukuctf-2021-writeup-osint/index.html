<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Gridsome - Gridsome</title><meta name="gridsome:hash" content="8ce65879d678184c88d712e3ffcc948147442edd"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/gridsome-blog/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/gridsome-blog/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/gridsome-blog/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/gridsome-blog/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/gridsome-blog/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/gridsome-blog/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/gridsome-blog/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/gridsome-blog/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/gridsome-blog/assets/css/0.styles.dd5de3ed.css" as="style"><link rel="preload" href="/gridsome-blog/assets/js/app.267df36e.js" as="script"><link rel="preload" href="/gridsome-blog/assets/js/page--src--templates--post-vue.c275e0ae.js" as="script"><link rel="prefetch" href="/gridsome-blog/assets/js/page--node-modules--gridsome--app--pages--404-vue.b08f0808.js"><link rel="prefetch" href="/gridsome-blog/assets/js/page--src--pages--index-vue.df9f8b29.js"><link rel="stylesheet" href="/gridsome-blog/assets/css/0.styles.dd5de3ed.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="layout"><header class="header"><strong><a href="/gridsome-blog/" class="active">Gridsome</a></strong><nav class="nav"><a href="/gridsome-blog/" class="nav__link active">Home</a></nav></header><div class="post-title"><h1>TsukuCTF2021 Writeup(OSINT)</h1><p class="post-date"> 16 September 2021 | 2 min read</p></div><div class="post-content"><p><p><a href="https://tsukuctf.sechack365.com/" target="_blank" rel="nofollow noopener noreferrer">TsukuCTF</a></p>
<p>ny_a です。ごめんなさい。</p>
<h2 id="osint"><a href="#osint" aria-hidden="true"><span class="icon icon-link"></span></a>OSINT</h2>
<p>OSINT メインの CTF なのに OSINT 以外の Writeup を書いてしまって反省しています。
ちゃんと書くので許して。</p>
<p>今回は Google Lens 問が多かったようですね。
Google Lens については知っておりました。
知っていましたが、これだけ問題数があって、100点くらいの問題から500点くらいの問題まであります。
ということは、高得点の問題は多分 Google Lens でも一筋縄ではいかない問題なのでしょう。
きっと運営スタッフが何度も Lens で位置をズラしながら検索しても全く出なかったから高得点になっているに違いありません。
つまり、Lens の運命に託す時間があれば、なんとか言葉で表現して検索してみて、
1つでも多くの検索結果に目を通すのが最適解ということです。やる気が湧いてきました。</p>
<p>よし、頑張るぞ〜〜〜〜〜〜〜！！！！！！！！！！！！！！！！</p>
<p>というわけで、ひたすらキーワードを基にした画像検索と Google Maps の目 grep でのパワープレイの記録をお楽しみください。</p>
<h3 id="ramen"><a href="#ramen" aria-hidden="true"><span class="icon icon-link"></span></a>ramen</h3>
<p>そのまま画像検索に投げてみるも、うまく見つからず。
というかキーワードが "soup" になってしまう。いや、気持ちは分かる。</p>
<p>インスタグラムのアカウントということなので、インスタ映えするラーメンを頑張って検索します。
「ラーメン インスタ」とかで検索したと思います。「ヤングコーン」とかもつけてみたけど出てこなかった記憶。</p>
<p>麺と同じような淡い黄色の、クリーミーそうなスープ。
これだけ麺と色が近かったら、麺もスープとの境界があまり認識できていないかもしれません。
それに加えてこの不透明度、こうなってしまうともう麺は溺れてし</p>
<p>……。</p>
<p>スープの色やヤングコーン、お皿などの特徴を目に焼きつけて、目 grep します。</p>
<p>すると、確かこの <a href="https://instagrammernews.com/detail/2245512484830076188" target="_blank" rel="nofollow noopener noreferrer">Instagrammer news</a>
が出てきました。ここに店の名前が書いてあるので、本店のアカウントを調べればいいです。</p>
<h3 id="shop"><a href="#shop" aria-hidden="true"><span class="icon icon-link"></span></a>shop</h3>
<p>なるほど、イオンモールですね。</p>
<p>近くを通った2台の車のナンバーが、多分名古屋と滋賀。じゃあ滋賀のあたりですかね、知らんけど。</p>
<p>トヨタの入っているイオンで探して、草津が出てきました。</p>
<h3 id="train"><a href="#train" aria-hidden="true"><span class="icon icon-link"></span></a>train</h3>
<p>山手線と京浜東北線が併走している区間ですね。
あと山手線の方面表示が、電光掲示板の表示の方は隠れていなくて、
片方は東京・上野方面、もう片方は品川・渋谷方面と書かれていることが分かります。</p>
<p>ということは、東京〜品川の、両端を含まない区間ということが分かります。</p>
<p>あとは京浜東北線の快速が通過する駅は有楽町と新橋だけに絞ることができるので、
構内図を見ながら北改札などの特徴に合致するか調べます。</p>
<p>15:35 から京浜東北線が停車するということで、時刻表から絞るかなーと思ったのですが、
普通に2択になったので時刻表は見ませんでした。</p>
<p>あと、普通に新橋ってこんな感じだったし工事してましたよね。うん。</p>
<h3 id="yuugen"><a href="#yuugen" aria-hidden="true"><span class="icon icon-link"></span></a>YUUGEN</h3>
<p>全国のキッズが大好きなやつ(偏見)ですね。</p>
<p>調べてみるとJR九州ということと、走っていた区間が分かります。</p>
<p>まあなんか、在来線の上を高架が分岐していく感じだということが分かります。</p>
<p>あとは Google Maps で航空写真をローリング作戦(しらみ潰し)で条件に合いそうな所を探します。</p>
<p>近くに黄色いビルなんかがあれば完璧ですね。</p>
<h3 id="beach"><a href="#beach" aria-hidden="true"><span class="icon icon-link"></span></a>Beach</h3>
<p>「レンタルスペース」「BBQ」という文字が見えますが、それ以外はあまり読み取れず……。</p>
<p>東京近郊とのことなので、「東京 海水浴」みたいに検索をして、海岸線などが似ている画像を探すと、江ノ島なんかがヒットします。
1枚目の奥に見える白いものは、江ノ島の灯台でしょうか。</p>
<p>Google Maps で手前の海岸線の情報をヒントにたどっていくと、サザンビーチちがさき海水浴場のあたりに、
Cの形のモニュメントがあることが分かります。</p>
<p>一番近い駅は茅ヶ崎ですね。</p>
<h3 id="tram"><a href="#tram" aria-hidden="true"><span class="icon icon-link"></span></a>tram</h3>
<p>海外のようです。日本の面積は地球上の陸地の1%に満たないので、だいたい探さなければいけない範囲が数百倍オーダーになることが分かります。
あと土地勘がないのが痛いですね。日本から出たことないので。</p>
<p>更に、夜の写真なので背景から情報を得にくいですね。
暗いところは見えにくく、明るいところも白く飛んでしまって見にくくなっていてつらいです。</p>
<p>読みやすいのは広告くらいです。スマートフォンの広告から地理的特徴を取るのは難しそうです。
見えにくい文字も見てみると、アルファベットにダイアクリティカルマークがついていることが分かります。
はい、アメリカではなさそうですね。</p>
<p>文字以外に読み取れる情報としては、厚着をしているので高緯度地域ではないのかなという印象と、
なんか管制塔みたいなイメージの特徴的な建物があることくらいでしょうか。
あと路面電車が交差していますね。これから探すのは少し厳しいので文字から調べましょう。</p>
<p>ダイアクリティカルマークを打つのは面倒なので、Googleがエスパーしてくれることを期待して"CSOB"で検索します。
きちんと読めそうな文字がそれくらいしかないので。</p>
<p>調べてみると銀行であることが分かります。めっちゃおしゃれですね。
kinko's みたいでよくないですか？いいなあ。私は好きです。kinko's 使ったことないけど。</p>
<p>あとはまあプラハのあたりの tram で調べると、プラハ市電が出てきます。Wikipediaのページを見てみると、いろいろ系統があるようです。
写真をもう一度見てみると、前に5と表示があります。5系統かなと考えて、
始点と終点の Sídliště Barrandov、Ústřední dílny Dopravního podniku あたりを調べてみます。
始点の方から路線が交差する所の近くの銀行を Google Maps の衛星写真から探していくと、
Anděl 駅の近くにそれらしい組み合わせがあります。ストリートビューで確認するとまさにそこでした。</p>
<h3 id="tsukushi_no_email1"><a href="#tsukushi_no_email1" aria-hidden="true"><span class="icon icon-link"></span></a>Tsukushi_no_email1</h3>
<p>Gmail で宛先メールアドレスを打ったあとダブルクリックすると、ユーザー情報が開きます。
アイコンにフラグがあるので、適当に画像を新しいタブで開いて確認します。</p>
<h3 id="tsukushi_no_email2"><a href="#tsukushi_no_email2" aria-hidden="true"><span class="icon icon-link"></span></a>Tsukushi_no_email2</h3>
<p>Google Calendar ですかね？メールアドレスから公開カレンダーを追加することができるので、自分のアカウントに追加してしまいます。
すると予定が1つ見えました。普通にフラグが書いてあります。</p>
<h3 id="cafe"><a href="#cafe" aria-hidden="true"><span class="icon icon-link"></span></a>cafe</h3>
<p>当該アカウントのメディア欄をさかのぼると、「萌え萌えキューーン」という写真付きツイートが見つかります。
画像は2枚あり、片方はインターネットで何度も見たことがあるものでした。</p>
<p>もう片方はオリジナルでしょうか。どうやら同じポーズをしているようです。
パロディという感じでしょうか。</p>
<p>窓の外向きに "PASTA" "OME……" という文字が見えますが、これはメニューを表わしているのでしょう。
ここから探すのは難しそうです。</p>
<p>キャストさんは胸元で手をクロスさせており、ここに名札があっても見えないでしょう。
(目線入っているし頭部は全く見ていませんでした。)
コスチュームをよく見ると "No.1 メイドカフェグループ" という文字が見えます。</p>
<p>ググったらめいどりーみんというグループのようです。
店舗一覧を見ると、それぞれの店舗で内装が結構違うようです。
空色のクロスが使われているのは秋葉原 中央通り店だけです。</p>
<p>ちなみに、Writeup を書きながらそのツイートを見ていたのですが、
ご本人にいいねされていたようで、ここを見ればすぐだったかなと思いました。</p>
<h3 id="train2"><a href="#train2" aria-hidden="true"><span class="icon icon-link"></span></a>train2</h3>
<p>駅にある文字としては乗車口の看板くらいでしょうか。</p>
<p>線路の向こう側には、踏切動作反応灯の下に「出町柳」の文字が見えます。</p>
<p>はい、出町柳と言えば京阪ですね。京阪と言えば出町柳です。
京阪乗る人おけいはん。意味が分からないと言われても動じることはありません。もう答えも目前です。
とはいえ、出町柳まで行ったことはあるものの、この乗車口の看板は見たことがありません。
「京阪 乗車口」なんかで検索してみますが、見覚えのあるものしか出てきません……。</p>
<p>なんか変だなーと思いながら Google Maps でしらみ潰しに京阪本線の路線を航空写真で見ていきます。
ホームが片方のみにある地上駅……、そんな駅に思い当たりません。。。</p>
<p>京阪にはいくつか別の路線があるのでそれも調べてみたのですが、
よく考えてみればそもそも本線以外は出町柳に行かないのでは……？</p>
<p>写真をもう一度見てみます。出町柳9号、これは踏切を表しているのでしょう。
ですが、京阪本線の出町柳周辺は地下を通っています。おかしい……。</p>
<p>出町柳9号で検索してみます。叡山電車が出てきます。はい。乗ったことないんですよねー。</p>
<p>踏切の名前にはだいたい隣の駅の名前がついていたはずです。出町柳から線路を見ていくと、
隣の元田中駅の写真であることが分かります。</p>
<p>すぐ京阪って分かって(？)よかったですね！！！！！！！！</p>
<h3 id="fishing"><a href="#fishing" aria-hidden="true"><span class="icon icon-link"></span></a>fishing</h3>
<p>あーはい、この橋ね、分かります。あーあの、あれです。あの、あー</p>
<p>超有名ブリッジですね。</p>
<p>とりあえず日本ということが分かりました。そんな辺鄙なところにはなかったはず。
いやなんというか、東京周辺じゃなかったですかね？</p>
<p>「東京 橋」とかで適当に画像検索してザーーーーーーーっと見ていきます。
あった。東京ゲートブリッジです。</p>
<p>そのままフラグとして投げてみます。incorrect……。釣り場ということでしたね、はい。</p>
<p>Google Mapsで見て、撮影地らしきあたりを見てみます。
若洲海浜公園というらしいです。それは知らなかったです。</p>
<p>超有名ブリッジの横にある、普遍釣り場。有名なものの近くにある、無名なもの。
えっもしかしてこの組み合わせって奇跡じゃないですかね？</p>
<p>……。</p>
<p>考えるまでもなくどこにでもあります。次行きましょう。</p>
<h3 id="dam"><a href="#dam" aria-hidden="true"><span class="icon icon-link"></span></a>dam</h3>
<p>えーっと、はい。自然ですね。すごい自然です。
特徴的なものといえば、奥の方に小さく見える赤い橋でしょうか。</p>
<p>適当に画像をクロッピングして Google の画像検索に投げてみますが、うまく見つかりません。</p>
<p>このなんというか、アーチ状の、橋、ですね。赤い。</p>
<p>「アーチ 橋」とかで画像検索してみます。
すると、<a href="https://images.app.goo.gl/DHFUCHUfBWHKuC96A" target="_blank" rel="nofollow noopener noreferrer">近いけど違う橋</a> が出てきます。</p>
<p>うーん、近いんだけどちょっと違うんだよな……と思いながらクリックしてみると、
関連画像に <a href="https://images.app.goo.gl/rnBvUAenJP2S1JTV9" target="_blank" rel="nofollow noopener noreferrer">めちゃくちゃそれっぽい画像</a> があるではないですか！！</p>
<p>Google Maps で見るとどうやらここで合っていることが分かります。</p>
<p>ちなみにこの橋、トラス構造 (レンティキュラートラス構造) らしいですね。橋梁、難しい……。</p>
<h3 id="park"><a href="#park" aria-hidden="true"><span class="icon icon-link"></span></a>park</h3>
<p>はい、完全に住宅街ですね。撮影した場所は少し高くなっていて、そのまま背後には山がある感じでしょうか。</p>
<p>拡大してみると、中央に何やら明るいものが2つくらいありますね。大きな反射板か何かがあって太陽の光でも反射しているのでしょうか。
(一応部活の大会とかでこういう投光設備のある会場には行ったことがあるのですが、昼で使われていなかったため全く思い当たらず……。)</p>
<p>新幹線が走っていることも分かります。東海道……にしては短い気がしますね。とはいえ新幹線沿線も(しらみ潰しに探すには)すこし範囲が広すぎます。
あとは新幹線の奥にネオン看板っぽい？ものが見えますが、文字は読めません。
また、新幹線の線路と高速道路のようなものが交差していそうだということも分かります。</p>
<p>写真の奥の方は、割と高い山が連続していることが分かります。恐らく海の方向を向いて撮られた写真ではなく、内陸の方を向いているのでしょう。
写真中央には高めのビルが2つ、左側の近い山の上には紅白の塔、その手前にはイオンらしき看板、
右側の山にはネットの張られた施設、右端には山の中にポツンと白い建物が見えることが分かります。</p>
<p>高速道路の沿線を見てみると、何やら見慣れないスーパーのような看板が見えます。
「スーパー ロゴ」で Google 画像検索してみると、サンリブというスーパーであることが分かります。
どうやら九州の方に展開しているようです。</p>
<p>ここで気付いてしまいます。さっきの問題でもJR九州が出てきたし、さては作文者が九州に住んでいるな……？と。
九州に住んでいるので、九州の問題が多く出題される。ということはこれも九州です。完全に読めました。</p>
<p>九州の新幹線、九州新幹線の近くにあるサンリブを Google Maps でしらみ潰しに見てみます。
どこにもそれらしいサンリブはありません。というより、それらしき山すらありません。</p>
<p>サンリブの店舗一覧を見てみます。中国地方にも展開しているようでした。
九州ではない可能性も出てきました。</p>
<p>とにかくサンリブの店舗を Google Maps で見ていくと、サンリブ 府中店が新幹線に程近くいい感じではないかと思いました。
左側の近い山は比治山でしょうか。紅白の塔もあります。近くに広島段原 ショッピングセンターがあり、イオンの看板があります。</p>
<p>中央の高いビルは、シティタワー広島とグランクロスタワー広島でしょうか。
ネットに囲まれた施設は広電ゴルフのようです。
山の中に見える白い建物はペルル中山南参番館ですかねー。</p>
<p>写真に写っている左の端を特定しましょう。本当の左端は木に隠れてしまって分かりづらいので、
新幹線の手前にある、屋根の上に屋上というか階段のある建物を探します。アーバンビュー府中八幡のようです。</p>
<p>右端は白い建物でよさそうです。その手前には、もしゃっとした森があります。
府中出張城跡だと仮定しましょう。
その近くには、何やら整然と部屋が並んだ施設と、かまぼこ型の施設があります。
近くを探してみると府中町立府中中学校とその体育館のようです。</p>
<p>府中町立府中中学校、府中町立府中中、府中町中立府中府中中…………</p>
<p>……ゲシュタルト崩壊してきましたが、続きを進めましょう。</p>
<p>これまでに分かっている位置同士を、写真で真っ直ぐ並んでいる所を結ぶように地図上に直線で結んでいきます。
そうすると、画角もだいたい分かっているため、写真の撮られた位置がかなり絞られます。</p>
<p>あとは、学校の手前の住宅地の屋根から詳しい位置を特定していきます。
太陽光パネルのある家が分かりやすいでしょうか。</p>
<p>それが見つかれば、あとは一番手前にある、三角の突起のある白い屋根の建物を探します。
山の中だから〜と山の方を探していると永遠に見つかりません。
直線を信じて探していくと、瀬戸ハイム第一児童遊園地 公衆トイレであることが分かります。</p>
<p>ちょうど後ろに道路が通っているので、ストリートビューで合っているか確認して、
問題なさそうなので、この問題との戦いに終止符を打ちます。対戦ありがとうございました。</p>
<h3 id="obog"><a href="#obog" aria-hidden="true"><span class="icon icon-link"></span></a>OBOG</h3>
<p>「SecHack365 非公式」で探すと、公式の <a href="https://twitter.com/SecHack365/status/1370017773817004037" target="_blank" rel="nofollow noopener noreferrer">ツイート</a>、
作文者の <a href="https://twitter.com/ryusei_ishika/status/1369996158530060289" target="_blank" rel="nofollow noopener noreferrer">ツイート</a> が出てきますがドメイン名が変わっているようです。
<a href="https://twitter.com/ryusei_ishika/status/1370260927879081986" target="_blank" rel="nofollow noopener noreferrer">リプライ</a> のページは生きていそうなので、ここから辿りました。</p>
<p>リポジトリへのリンクがあるので確認します。
CI/CD は使っているでしょうが、コミットログにその変更が残っていれば簡単に分かってしまうでしょう。
一応コミットを見てみましたが、怪しいコミットはなさそうです。</p>
<p>となると、CI/CD を無視して、サーバー上のデータだけ書き換えた感じでしょうか。
ソースを clone してきてビルドして、実際のサーバー上のファイルと比較してもいいですが、面倒です。</p>
<p>適当に開発者ツールを開きながらページを探索していると、コンソールに何か怪しいログが出ています。
見てみると、「締切駆動コース」というページが怪しいです。</p>
<p>そのあたりのソースを見てみると、<a href="https://github.com/SecHack365-Fans/SecHack365-Fans.github.io/blob/master/src/pages/timer/script/display.js" target="_blank" rel="nofollow noopener noreferrer">src/pages/timer/script/display.js</a>
で <code>console.log</code> を呼んでいるようです。blame してみると、
<a href="https://github.com/SecHack365-Fans/SecHack365-Fans.github.io/commit/2243cd0f7dcab26698854b6b9a645365aa18d293" target="_blank" rel="nofollow noopener noreferrer">fix: 微細な修正</a>
というコミットで base64 デコードしないように修正されているようでした。</p>
<p>まあ、適当に <code>base64 -d</code> に食わせてデコードしてみると、フラグが得られるという感じですね。</p>
<h3 id="interplanetary-protocol"><a href="#interplanetary-protocol" aria-hidden="true"><span class="icon icon-link"></span></a>InterPlanetary Protocol</h3>
<p>なんか先頭7文字が同じなので(<code>http://</code> ？)換字暗号かなと思ったのですが、よく分かりません。
先頭7文字で検索してみると、ipfs というものがヒットします。
"<a href="https://ipfs.io/ipfs/bafybei%E2%80%A6%E2%80%A6" target="_blank" rel="nofollow noopener noreferrer">https://ipfs.io/ipfs/bafybei……</a>" という URL の一部？がたくさんヒットするので、
ここに3つの特殊な URL を入れてみると、フラグの断片が得られます。</p>
<p>アンダーバーが2つ連続しているので、多分ミスだろうな〜と思いながら、
twitter かどこかで修正済みだと見た気がしたのでそのまま投げました。</p>
<h3 id="wildtsukushi"><a href="#wildtsukushi" aria-hidden="true"><span class="icon icon-link"></span></a>WildTsukushi</h3>
<p>解けませんでした。</p>
<p>「きりん」「恐竜」「遊具」「滑り台」「つくし」「港」「海岸」など手当たり次第に思いつくキーワードで検索してみましたが、
見つからず……。</p>
<p>他の人の writeup で、いみのさんの最近のメディアツイートに近くの写真があった、と見たのですが、
いやこのツイートはTLで見てました……見たけど全く思い出せず……分からないよ……</p>
<h3 id="uiui"><a href="#uiui" aria-hidden="true"><span class="icon icon-link"></span></a>uiui</h3>
<p>zip のパスワードは、一般的に <code>infected</code> とかが使われるようです。
少しググったら出てきますし、セキュリティキャンプでも講義で実際にこのパスワードが使用されました。</p>
<p>適当に unar (<a href="https://archlinux.org/packages/community/x86_64/unarchiver/" target="_blank" rel="nofollow noopener noreferrer">unarchiver</a>) で解凍して、
(こいつは複数ファイルを解凍すると自動でアーカイブのファイル名なディレクトリを作ってくれてちょっと便利です、)
(今回はファイルが1つだけだったのでディレクトリは作成されませんでした、)
(zsh では cd を省略してディレクトリを実行すると cd してくれます、)
(アーカイブのファイル名と中身のファイル名が同じでした、)
という感じで解凍したディレクトリに cd して……しようとして、
<code>./Virus</code> を実行して普通にバイナリをホストで実行してしまいました。</p>
<p>インシデントです……。ごめんなさい……。
皆さん！！！！インシデントはこのような偶然？の組み合わせで起こります！！！！！！気をつけましょう！！！！！</p>
<p>ps で変なプロセスが残っていないことを確認して、まあ CTF だしマルウェアではないだろうと運営を信じることにします。</p>
<p>あとは頑張って Gdidra でリバーシングを頑張ります。というか自分のことも運営も信じられないので徹底的に動作を確認します。
でもまあいくら頑張ってもテキストを表示して終了するだけのようにしか見えません。自己書き換えコードでもなさそうです。
さあ、困った。インシデントも発生させたしお手上げです。</p>
<p>……という感じで諦めてしばらく放置していたんですが、「IoC と IaC って似てるよな……フヒヒw」とか
「IoC って初めて聞いたとき普通にオリンピック時期だし IOC かと思ったよ」とかクソくだらないことを考えていたら、
sha256sum から調べることを思いつきました。</p>
<p>でまあ一応 Google で検索してみるんですが、出るわけがありません。
宅配便の伝票番号みたいに「8fa168f38e54fb0f63e6674a4f463ef3a0971f71546e6f4ed1b69c121d1de1f3 を VirusTotal で見る」
なんてリンクが出てきたら一般の人は混乱してしまいますよね。</p>
<p>なのでまあ VirusTotal を開いて、sha256 をペーストして……と思ったのですが、デフォルトでファイルを選択する画面が出ていました。
何も考えずにアップロードして……</p>
<p>…………</p>
<p>インシデントです……。ごめんなさい……。
皆さん！！！！！！！！！！！！！……</p>
<p>フラグが私の胸に深く刺さりました。申し訳ございませんでした。</p>
<p>想定解法(一歩手前？)で正答しましたが、完全に不正解です。なんなら今から点数下げてもらっても構わないレベルです……。
CTF でよかった……………………</p>
<p>ちゃんとサンドボックスで解凍しましょう！！！！ホストで解凍厳禁！！！！！ホストに生バイナリ出さない！！！！
肝に命じておきます。</p>
<h3 id="udon"><a href="#udon" aria-hidden="true"><span class="icon icon-link"></span></a>udon</h3>
<p>解けませんでした。</p>
<p>ひたすらカレーうどんを検索しました。</p>
<p>おしまい。</p>
</p></div><div class="footer"><p>
      Built with
      <a href="//gridsome.org" class="link">Gridsome</a></p></div></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"id":"3c535a970f5d48d0f3888db1deeac0ca","title":"TsukuCTF2021 Writeup(OSINT)","content":"\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Ftsukuctf.sechack365.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ETsukuCTF\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003Eny_a です。ごめんなさい。\u003C\u002Fp\u003E\n\u003Ch2 id=\"osint\"\u003E\u003Ca href=\"#osint\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EOSINT\u003C\u002Fh2\u003E\n\u003Cp\u003EOSINT メインの CTF なのに OSINT 以外の Writeup を書いてしまって反省しています。\nちゃんと書くので許して。\u003C\u002Fp\u003E\n\u003Cp\u003E今回は Google Lens 問が多かったようですね。\nGoogle Lens については知っておりました。\n知っていましたが、これだけ問題数があって、100点くらいの問題から500点くらいの問題まであります。\nということは、高得点の問題は多分 Google Lens でも一筋縄ではいかない問題なのでしょう。\nきっと運営スタッフが何度も Lens で位置をズラしながら検索しても全く出なかったから高得点になっているに違いありません。\nつまり、Lens の運命に託す時間があれば、なんとか言葉で表現して検索してみて、\n1つでも多くの検索結果に目を通すのが最適解ということです。やる気が湧いてきました。\u003C\u002Fp\u003E\n\u003Cp\u003Eよし、頑張るぞ〜〜〜〜〜〜〜！！！！！！！！！！！！！！！！\u003C\u002Fp\u003E\n\u003Cp\u003Eというわけで、ひたすらキーワードを基にした画像検索と Google Maps の目 grep でのパワープレイの記録をお楽しみください。\u003C\u002Fp\u003E\n\u003Ch3 id=\"ramen\"\u003E\u003Ca href=\"#ramen\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Eramen\u003C\u002Fh3\u003E\n\u003Cp\u003Eそのまま画像検索に投げてみるも、うまく見つからず。\nというかキーワードが \"soup\" になってしまう。いや、気持ちは分かる。\u003C\u002Fp\u003E\n\u003Cp\u003Eインスタグラムのアカウントということなので、インスタ映えするラーメンを頑張って検索します。\n「ラーメン インスタ」とかで検索したと思います。「ヤングコーン」とかもつけてみたけど出てこなかった記憶。\u003C\u002Fp\u003E\n\u003Cp\u003E麺と同じような淡い黄色の、クリーミーそうなスープ。\nこれだけ麺と色が近かったら、麺もスープとの境界があまり認識できていないかもしれません。\nそれに加えてこの不透明度、こうなってしまうともう麺は溺れてし\u003C\u002Fp\u003E\n\u003Cp\u003E……。\u003C\u002Fp\u003E\n\u003Cp\u003Eスープの色やヤングコーン、お皿などの特徴を目に焼きつけて、目 grep します。\u003C\u002Fp\u003E\n\u003Cp\u003Eすると、確かこの \u003Ca href=\"https:\u002F\u002Finstagrammernews.com\u002Fdetail\u002F2245512484830076188\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EInstagrammer news\u003C\u002Fa\u003E\nが出てきました。ここに店の名前が書いてあるので、本店のアカウントを調べればいいです。\u003C\u002Fp\u003E\n\u003Ch3 id=\"shop\"\u003E\u003Ca href=\"#shop\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Eshop\u003C\u002Fh3\u003E\n\u003Cp\u003Eなるほど、イオンモールですね。\u003C\u002Fp\u003E\n\u003Cp\u003E近くを通った2台の車のナンバーが、多分名古屋と滋賀。じゃあ滋賀のあたりですかね、知らんけど。\u003C\u002Fp\u003E\n\u003Cp\u003Eトヨタの入っているイオンで探して、草津が出てきました。\u003C\u002Fp\u003E\n\u003Ch3 id=\"train\"\u003E\u003Ca href=\"#train\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Etrain\u003C\u002Fh3\u003E\n\u003Cp\u003E山手線と京浜東北線が併走している区間ですね。\nあと山手線の方面表示が、電光掲示板の表示の方は隠れていなくて、\n片方は東京・上野方面、もう片方は品川・渋谷方面と書かれていることが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003Eということは、東京〜品川の、両端を含まない区間ということが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003Eあとは京浜東北線の快速が通過する駅は有楽町と新橋だけに絞ることができるので、\n構内図を見ながら北改札などの特徴に合致するか調べます。\u003C\u002Fp\u003E\n\u003Cp\u003E15:35 から京浜東北線が停車するということで、時刻表から絞るかなーと思ったのですが、\n普通に2択になったので時刻表は見ませんでした。\u003C\u002Fp\u003E\n\u003Cp\u003Eあと、普通に新橋ってこんな感じだったし工事してましたよね。うん。\u003C\u002Fp\u003E\n\u003Ch3 id=\"yuugen\"\u003E\u003Ca href=\"#yuugen\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EYUUGEN\u003C\u002Fh3\u003E\n\u003Cp\u003E全国のキッズが大好きなやつ(偏見)ですね。\u003C\u002Fp\u003E\n\u003Cp\u003E調べてみるとJR九州ということと、走っていた区間が分かります。\u003C\u002Fp\u003E\n\u003Cp\u003Eまあなんか、在来線の上を高架が分岐していく感じだということが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003Eあとは Google Maps で航空写真をローリング作戦(しらみ潰し)で条件に合いそうな所を探します。\u003C\u002Fp\u003E\n\u003Cp\u003E近くに黄色いビルなんかがあれば完璧ですね。\u003C\u002Fp\u003E\n\u003Ch3 id=\"beach\"\u003E\u003Ca href=\"#beach\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EBeach\u003C\u002Fh3\u003E\n\u003Cp\u003E「レンタルスペース」「BBQ」という文字が見えますが、それ以外はあまり読み取れず……。\u003C\u002Fp\u003E\n\u003Cp\u003E東京近郊とのことなので、「東京 海水浴」みたいに検索をして、海岸線などが似ている画像を探すと、江ノ島なんかがヒットします。\n1枚目の奥に見える白いものは、江ノ島の灯台でしょうか。\u003C\u002Fp\u003E\n\u003Cp\u003EGoogle Maps で手前の海岸線の情報をヒントにたどっていくと、サザンビーチちがさき海水浴場のあたりに、\nCの形のモニュメントがあることが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003E一番近い駅は茅ヶ崎ですね。\u003C\u002Fp\u003E\n\u003Ch3 id=\"tram\"\u003E\u003Ca href=\"#tram\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Etram\u003C\u002Fh3\u003E\n\u003Cp\u003E海外のようです。日本の面積は地球上の陸地の1%に満たないので、だいたい探さなければいけない範囲が数百倍オーダーになることが分かります。\nあと土地勘がないのが痛いですね。日本から出たことないので。\u003C\u002Fp\u003E\n\u003Cp\u003E更に、夜の写真なので背景から情報を得にくいですね。\n暗いところは見えにくく、明るいところも白く飛んでしまって見にくくなっていてつらいです。\u003C\u002Fp\u003E\n\u003Cp\u003E読みやすいのは広告くらいです。スマートフォンの広告から地理的特徴を取るのは難しそうです。\n見えにくい文字も見てみると、アルファベットにダイアクリティカルマークがついていることが分かります。\nはい、アメリカではなさそうですね。\u003C\u002Fp\u003E\n\u003Cp\u003E文字以外に読み取れる情報としては、厚着をしているので高緯度地域ではないのかなという印象と、\nなんか管制塔みたいなイメージの特徴的な建物があることくらいでしょうか。\nあと路面電車が交差していますね。これから探すのは少し厳しいので文字から調べましょう。\u003C\u002Fp\u003E\n\u003Cp\u003Eダイアクリティカルマークを打つのは面倒なので、Googleがエスパーしてくれることを期待して\"CSOB\"で検索します。\nきちんと読めそうな文字がそれくらいしかないので。\u003C\u002Fp\u003E\n\u003Cp\u003E調べてみると銀行であることが分かります。めっちゃおしゃれですね。\nkinko's みたいでよくないですか？いいなあ。私は好きです。kinko's 使ったことないけど。\u003C\u002Fp\u003E\n\u003Cp\u003Eあとはまあプラハのあたりの tram で調べると、プラハ市電が出てきます。Wikipediaのページを見てみると、いろいろ系統があるようです。\n写真をもう一度見てみると、前に5と表示があります。5系統かなと考えて、\n始点と終点の Sídliště Barrandov、Ústřední dílny Dopravního podniku あたりを調べてみます。\n始点の方から路線が交差する所の近くの銀行を Google Maps の衛星写真から探していくと、\nAnděl 駅の近くにそれらしい組み合わせがあります。ストリートビューで確認するとまさにそこでした。\u003C\u002Fp\u003E\n\u003Ch3 id=\"tsukushi_no_email1\"\u003E\u003Ca href=\"#tsukushi_no_email1\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ETsukushi_no_email1\u003C\u002Fh3\u003E\n\u003Cp\u003EGmail で宛先メールアドレスを打ったあとダブルクリックすると、ユーザー情報が開きます。\nアイコンにフラグがあるので、適当に画像を新しいタブで開いて確認します。\u003C\u002Fp\u003E\n\u003Ch3 id=\"tsukushi_no_email2\"\u003E\u003Ca href=\"#tsukushi_no_email2\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ETsukushi_no_email2\u003C\u002Fh3\u003E\n\u003Cp\u003EGoogle Calendar ですかね？メールアドレスから公開カレンダーを追加することができるので、自分のアカウントに追加してしまいます。\nすると予定が1つ見えました。普通にフラグが書いてあります。\u003C\u002Fp\u003E\n\u003Ch3 id=\"cafe\"\u003E\u003Ca href=\"#cafe\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Ecafe\u003C\u002Fh3\u003E\n\u003Cp\u003E当該アカウントのメディア欄をさかのぼると、「萌え萌えキューーン」という写真付きツイートが見つかります。\n画像は2枚あり、片方はインターネットで何度も見たことがあるものでした。\u003C\u002Fp\u003E\n\u003Cp\u003Eもう片方はオリジナルでしょうか。どうやら同じポーズをしているようです。\nパロディという感じでしょうか。\u003C\u002Fp\u003E\n\u003Cp\u003E窓の外向きに \"PASTA\" \"OME……\" という文字が見えますが、これはメニューを表わしているのでしょう。\nここから探すのは難しそうです。\u003C\u002Fp\u003E\n\u003Cp\u003Eキャストさんは胸元で手をクロスさせており、ここに名札があっても見えないでしょう。\n(目線入っているし頭部は全く見ていませんでした。)\nコスチュームをよく見ると \"No.1 メイドカフェグループ\" という文字が見えます。\u003C\u002Fp\u003E\n\u003Cp\u003Eググったらめいどりーみんというグループのようです。\n店舗一覧を見ると、それぞれの店舗で内装が結構違うようです。\n空色のクロスが使われているのは秋葉原 中央通り店だけです。\u003C\u002Fp\u003E\n\u003Cp\u003Eちなみに、Writeup を書きながらそのツイートを見ていたのですが、\nご本人にいいねされていたようで、ここを見ればすぐだったかなと思いました。\u003C\u002Fp\u003E\n\u003Ch3 id=\"train2\"\u003E\u003Ca href=\"#train2\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Etrain2\u003C\u002Fh3\u003E\n\u003Cp\u003E駅にある文字としては乗車口の看板くらいでしょうか。\u003C\u002Fp\u003E\n\u003Cp\u003E線路の向こう側には、踏切動作反応灯の下に「出町柳」の文字が見えます。\u003C\u002Fp\u003E\n\u003Cp\u003Eはい、出町柳と言えば京阪ですね。京阪と言えば出町柳です。\n京阪乗る人おけいはん。意味が分からないと言われても動じることはありません。もう答えも目前です。\nとはいえ、出町柳まで行ったことはあるものの、この乗車口の看板は見たことがありません。\n「京阪 乗車口」なんかで検索してみますが、見覚えのあるものしか出てきません……。\u003C\u002Fp\u003E\n\u003Cp\u003Eなんか変だなーと思いながら Google Maps でしらみ潰しに京阪本線の路線を航空写真で見ていきます。\nホームが片方のみにある地上駅……、そんな駅に思い当たりません。。。\u003C\u002Fp\u003E\n\u003Cp\u003E京阪にはいくつか別の路線があるのでそれも調べてみたのですが、\nよく考えてみればそもそも本線以外は出町柳に行かないのでは……？\u003C\u002Fp\u003E\n\u003Cp\u003E写真をもう一度見てみます。出町柳9号、これは踏切を表しているのでしょう。\nですが、京阪本線の出町柳周辺は地下を通っています。おかしい……。\u003C\u002Fp\u003E\n\u003Cp\u003E出町柳9号で検索してみます。叡山電車が出てきます。はい。乗ったことないんですよねー。\u003C\u002Fp\u003E\n\u003Cp\u003E踏切の名前にはだいたい隣の駅の名前がついていたはずです。出町柳から線路を見ていくと、\n隣の元田中駅の写真であることが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003Eすぐ京阪って分かって(？)よかったですね！！！！！！！！\u003C\u002Fp\u003E\n\u003Ch3 id=\"fishing\"\u003E\u003Ca href=\"#fishing\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Efishing\u003C\u002Fh3\u003E\n\u003Cp\u003Eあーはい、この橋ね、分かります。あーあの、あれです。あの、あー\u003C\u002Fp\u003E\n\u003Cp\u003E超有名ブリッジですね。\u003C\u002Fp\u003E\n\u003Cp\u003Eとりあえず日本ということが分かりました。そんな辺鄙なところにはなかったはず。\nいやなんというか、東京周辺じゃなかったですかね？\u003C\u002Fp\u003E\n\u003Cp\u003E「東京 橋」とかで適当に画像検索してザーーーーーーーっと見ていきます。\nあった。東京ゲートブリッジです。\u003C\u002Fp\u003E\n\u003Cp\u003Eそのままフラグとして投げてみます。incorrect……。釣り場ということでしたね、はい。\u003C\u002Fp\u003E\n\u003Cp\u003EGoogle Mapsで見て、撮影地らしきあたりを見てみます。\n若洲海浜公園というらしいです。それは知らなかったです。\u003C\u002Fp\u003E\n\u003Cp\u003E超有名ブリッジの横にある、普遍釣り場。有名なものの近くにある、無名なもの。\nえっもしかしてこの組み合わせって奇跡じゃないですかね？\u003C\u002Fp\u003E\n\u003Cp\u003E……。\u003C\u002Fp\u003E\n\u003Cp\u003E考えるまでもなくどこにでもあります。次行きましょう。\u003C\u002Fp\u003E\n\u003Ch3 id=\"dam\"\u003E\u003Ca href=\"#dam\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Edam\u003C\u002Fh3\u003E\n\u003Cp\u003Eえーっと、はい。自然ですね。すごい自然です。\n特徴的なものといえば、奥の方に小さく見える赤い橋でしょうか。\u003C\u002Fp\u003E\n\u003Cp\u003E適当に画像をクロッピングして Google の画像検索に投げてみますが、うまく見つかりません。\u003C\u002Fp\u003E\n\u003Cp\u003Eこのなんというか、アーチ状の、橋、ですね。赤い。\u003C\u002Fp\u003E\n\u003Cp\u003E「アーチ 橋」とかで画像検索してみます。\nすると、\u003Ca href=\"https:\u002F\u002Fimages.app.goo.gl\u002FDHFUCHUfBWHKuC96A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E近いけど違う橋\u003C\u002Fa\u003E が出てきます。\u003C\u002Fp\u003E\n\u003Cp\u003Eうーん、近いんだけどちょっと違うんだよな……と思いながらクリックしてみると、\n関連画像に \u003Ca href=\"https:\u002F\u002Fimages.app.goo.gl\u002FrnBvUAenJP2S1JTV9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eめちゃくちゃそれっぽい画像\u003C\u002Fa\u003E があるではないですか！！\u003C\u002Fp\u003E\n\u003Cp\u003EGoogle Maps で見るとどうやらここで合っていることが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003Eちなみにこの橋、トラス構造 (レンティキュラートラス構造) らしいですね。橋梁、難しい……。\u003C\u002Fp\u003E\n\u003Ch3 id=\"park\"\u003E\u003Ca href=\"#park\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Epark\u003C\u002Fh3\u003E\n\u003Cp\u003Eはい、完全に住宅街ですね。撮影した場所は少し高くなっていて、そのまま背後には山がある感じでしょうか。\u003C\u002Fp\u003E\n\u003Cp\u003E拡大してみると、中央に何やら明るいものが2つくらいありますね。大きな反射板か何かがあって太陽の光でも反射しているのでしょうか。\n(一応部活の大会とかでこういう投光設備のある会場には行ったことがあるのですが、昼で使われていなかったため全く思い当たらず……。)\u003C\u002Fp\u003E\n\u003Cp\u003E新幹線が走っていることも分かります。東海道……にしては短い気がしますね。とはいえ新幹線沿線も(しらみ潰しに探すには)すこし範囲が広すぎます。\nあとは新幹線の奥にネオン看板っぽい？ものが見えますが、文字は読めません。\nまた、新幹線の線路と高速道路のようなものが交差していそうだということも分かります。\u003C\u002Fp\u003E\n\u003Cp\u003E写真の奥の方は、割と高い山が連続していることが分かります。恐らく海の方向を向いて撮られた写真ではなく、内陸の方を向いているのでしょう。\n写真中央には高めのビルが2つ、左側の近い山の上には紅白の塔、その手前にはイオンらしき看板、\n右側の山にはネットの張られた施設、右端には山の中にポツンと白い建物が見えることが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003E高速道路の沿線を見てみると、何やら見慣れないスーパーのような看板が見えます。\n「スーパー ロゴ」で Google 画像検索してみると、サンリブというスーパーであることが分かります。\nどうやら九州の方に展開しているようです。\u003C\u002Fp\u003E\n\u003Cp\u003Eここで気付いてしまいます。さっきの問題でもJR九州が出てきたし、さては作文者が九州に住んでいるな……？と。\n九州に住んでいるので、九州の問題が多く出題される。ということはこれも九州です。完全に読めました。\u003C\u002Fp\u003E\n\u003Cp\u003E九州の新幹線、九州新幹線の近くにあるサンリブを Google Maps でしらみ潰しに見てみます。\nどこにもそれらしいサンリブはありません。というより、それらしき山すらありません。\u003C\u002Fp\u003E\n\u003Cp\u003Eサンリブの店舗一覧を見てみます。中国地方にも展開しているようでした。\n九州ではない可能性も出てきました。\u003C\u002Fp\u003E\n\u003Cp\u003Eとにかくサンリブの店舗を Google Maps で見ていくと、サンリブ 府中店が新幹線に程近くいい感じではないかと思いました。\n左側の近い山は比治山でしょうか。紅白の塔もあります。近くに広島段原 ショッピングセンターがあり、イオンの看板があります。\u003C\u002Fp\u003E\n\u003Cp\u003E中央の高いビルは、シティタワー広島とグランクロスタワー広島でしょうか。\nネットに囲まれた施設は広電ゴルフのようです。\n山の中に見える白い建物はペルル中山南参番館ですかねー。\u003C\u002Fp\u003E\n\u003Cp\u003E写真に写っている左の端を特定しましょう。本当の左端は木に隠れてしまって分かりづらいので、\n新幹線の手前にある、屋根の上に屋上というか階段のある建物を探します。アーバンビュー府中八幡のようです。\u003C\u002Fp\u003E\n\u003Cp\u003E右端は白い建物でよさそうです。その手前には、もしゃっとした森があります。\n府中出張城跡だと仮定しましょう。\nその近くには、何やら整然と部屋が並んだ施設と、かまぼこ型の施設があります。\n近くを探してみると府中町立府中中学校とその体育館のようです。\u003C\u002Fp\u003E\n\u003Cp\u003E府中町立府中中学校、府中町立府中中、府中町中立府中府中中…………\u003C\u002Fp\u003E\n\u003Cp\u003E……ゲシュタルト崩壊してきましたが、続きを進めましょう。\u003C\u002Fp\u003E\n\u003Cp\u003Eこれまでに分かっている位置同士を、写真で真っ直ぐ並んでいる所を結ぶように地図上に直線で結んでいきます。\nそうすると、画角もだいたい分かっているため、写真の撮られた位置がかなり絞られます。\u003C\u002Fp\u003E\n\u003Cp\u003Eあとは、学校の手前の住宅地の屋根から詳しい位置を特定していきます。\n太陽光パネルのある家が分かりやすいでしょうか。\u003C\u002Fp\u003E\n\u003Cp\u003Eそれが見つかれば、あとは一番手前にある、三角の突起のある白い屋根の建物を探します。\n山の中だから〜と山の方を探していると永遠に見つかりません。\n直線を信じて探していくと、瀬戸ハイム第一児童遊園地 公衆トイレであることが分かります。\u003C\u002Fp\u003E\n\u003Cp\u003Eちょうど後ろに道路が通っているので、ストリートビューで合っているか確認して、\n問題なさそうなので、この問題との戦いに終止符を打ちます。対戦ありがとうございました。\u003C\u002Fp\u003E\n\u003Ch3 id=\"obog\"\u003E\u003Ca href=\"#obog\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EOBOG\u003C\u002Fh3\u003E\n\u003Cp\u003E「SecHack365 非公式」で探すと、公式の \u003Ca href=\"https:\u002F\u002Ftwitter.com\u002FSecHack365\u002Fstatus\u002F1370017773817004037\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eツイート\u003C\u002Fa\u003E、\n作文者の \u003Ca href=\"https:\u002F\u002Ftwitter.com\u002Fryusei_ishika\u002Fstatus\u002F1369996158530060289\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eツイート\u003C\u002Fa\u003E が出てきますがドメイン名が変わっているようです。\n\u003Ca href=\"https:\u002F\u002Ftwitter.com\u002Fryusei_ishika\u002Fstatus\u002F1370260927879081986\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eリプライ\u003C\u002Fa\u003E のページは生きていそうなので、ここから辿りました。\u003C\u002Fp\u003E\n\u003Cp\u003Eリポジトリへのリンクがあるので確認します。\nCI\u002FCD は使っているでしょうが、コミットログにその変更が残っていれば簡単に分かってしまうでしょう。\n一応コミットを見てみましたが、怪しいコミットはなさそうです。\u003C\u002Fp\u003E\n\u003Cp\u003Eとなると、CI\u002FCD を無視して、サーバー上のデータだけ書き換えた感じでしょうか。\nソースを clone してきてビルドして、実際のサーバー上のファイルと比較してもいいですが、面倒です。\u003C\u002Fp\u003E\n\u003Cp\u003E適当に開発者ツールを開きながらページを探索していると、コンソールに何か怪しいログが出ています。\n見てみると、「締切駆動コース」というページが怪しいです。\u003C\u002Fp\u003E\n\u003Cp\u003Eそのあたりのソースを見てみると、\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSecHack365-Fans\u002FSecHack365-Fans.github.io\u002Fblob\u002Fmaster\u002Fsrc\u002Fpages\u002Ftimer\u002Fscript\u002Fdisplay.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Esrc\u002Fpages\u002Ftimer\u002Fscript\u002Fdisplay.js\u003C\u002Fa\u003E\nで \u003Ccode\u003Econsole.log\u003C\u002Fcode\u003E を呼んでいるようです。blame してみると、\n\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSecHack365-Fans\u002FSecHack365-Fans.github.io\u002Fcommit\u002F2243cd0f7dcab26698854b6b9a645365aa18d293\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Efix: 微細な修正\u003C\u002Fa\u003E\nというコミットで base64 デコードしないように修正されているようでした。\u003C\u002Fp\u003E\n\u003Cp\u003Eまあ、適当に \u003Ccode\u003Ebase64 -d\u003C\u002Fcode\u003E に食わせてデコードしてみると、フラグが得られるという感じですね。\u003C\u002Fp\u003E\n\u003Ch3 id=\"interplanetary-protocol\"\u003E\u003Ca href=\"#interplanetary-protocol\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInterPlanetary Protocol\u003C\u002Fh3\u003E\n\u003Cp\u003Eなんか先頭7文字が同じなので(\u003Ccode\u003Ehttp:\u002F\u002F\u003C\u002Fcode\u003E ？)換字暗号かなと思ったのですが、よく分かりません。\n先頭7文字で検索してみると、ipfs というものがヒットします。\n\"\u003Ca href=\"https:\u002F\u002Fipfs.io\u002Fipfs\u002Fbafybei%E2%80%A6%E2%80%A6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fipfs.io\u002Fipfs\u002Fbafybei……\u003C\u002Fa\u003E\" という URL の一部？がたくさんヒットするので、\nここに3つの特殊な URL を入れてみると、フラグの断片が得られます。\u003C\u002Fp\u003E\n\u003Cp\u003Eアンダーバーが2つ連続しているので、多分ミスだろうな〜と思いながら、\ntwitter かどこかで修正済みだと見た気がしたのでそのまま投げました。\u003C\u002Fp\u003E\n\u003Ch3 id=\"wildtsukushi\"\u003E\u003Ca href=\"#wildtsukushi\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWildTsukushi\u003C\u002Fh3\u003E\n\u003Cp\u003E解けませんでした。\u003C\u002Fp\u003E\n\u003Cp\u003E「きりん」「恐竜」「遊具」「滑り台」「つくし」「港」「海岸」など手当たり次第に思いつくキーワードで検索してみましたが、\n見つからず……。\u003C\u002Fp\u003E\n\u003Cp\u003E他の人の writeup で、いみのさんの最近のメディアツイートに近くの写真があった、と見たのですが、\nいやこのツイートはTLで見てました……見たけど全く思い出せず……分からないよ……\u003C\u002Fp\u003E\n\u003Ch3 id=\"uiui\"\u003E\u003Ca href=\"#uiui\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Euiui\u003C\u002Fh3\u003E\n\u003Cp\u003Ezip のパスワードは、一般的に \u003Ccode\u003Einfected\u003C\u002Fcode\u003E とかが使われるようです。\n少しググったら出てきますし、セキュリティキャンプでも講義で実際にこのパスワードが使用されました。\u003C\u002Fp\u003E\n\u003Cp\u003E適当に unar (\u003Ca href=\"https:\u002F\u002Farchlinux.org\u002Fpackages\u002Fcommunity\u002Fx86_64\u002Funarchiver\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eunarchiver\u003C\u002Fa\u003E) で解凍して、\n(こいつは複数ファイルを解凍すると自動でアーカイブのファイル名なディレクトリを作ってくれてちょっと便利です、)\n(今回はファイルが1つだけだったのでディレクトリは作成されませんでした、)\n(zsh では cd を省略してディレクトリを実行すると cd してくれます、)\n(アーカイブのファイル名と中身のファイル名が同じでした、)\nという感じで解凍したディレクトリに cd して……しようとして、\n\u003Ccode\u003E.\u002FVirus\u003C\u002Fcode\u003E を実行して普通にバイナリをホストで実行してしまいました。\u003C\u002Fp\u003E\n\u003Cp\u003Eインシデントです……。ごめんなさい……。\n皆さん！！！！インシデントはこのような偶然？の組み合わせで起こります！！！！！！気をつけましょう！！！！！\u003C\u002Fp\u003E\n\u003Cp\u003Eps で変なプロセスが残っていないことを確認して、まあ CTF だしマルウェアではないだろうと運営を信じることにします。\u003C\u002Fp\u003E\n\u003Cp\u003Eあとは頑張って Gdidra でリバーシングを頑張ります。というか自分のことも運営も信じられないので徹底的に動作を確認します。\nでもまあいくら頑張ってもテキストを表示して終了するだけのようにしか見えません。自己書き換えコードでもなさそうです。\nさあ、困った。インシデントも発生させたしお手上げです。\u003C\u002Fp\u003E\n\u003Cp\u003E……という感じで諦めてしばらく放置していたんですが、「IoC と IaC って似てるよな……フヒヒw」とか\n「IoC って初めて聞いたとき普通にオリンピック時期だし IOC かと思ったよ」とかクソくだらないことを考えていたら、\nsha256sum から調べることを思いつきました。\u003C\u002Fp\u003E\n\u003Cp\u003Eでまあ一応 Google で検索してみるんですが、出るわけがありません。\n宅配便の伝票番号みたいに「8fa168f38e54fb0f63e6674a4f463ef3a0971f71546e6f4ed1b69c121d1de1f3 を VirusTotal で見る」\nなんてリンクが出てきたら一般の人は混乱してしまいますよね。\u003C\u002Fp\u003E\n\u003Cp\u003Eなのでまあ VirusTotal を開いて、sha256 をペーストして……と思ったのですが、デフォルトでファイルを選択する画面が出ていました。\n何も考えずにアップロードして……\u003C\u002Fp\u003E\n\u003Cp\u003E…………\u003C\u002Fp\u003E\n\u003Cp\u003Eインシデントです……。ごめんなさい……。\n皆さん！！！！！！！！！！！！！……\u003C\u002Fp\u003E\n\u003Cp\u003Eフラグが私の胸に深く刺さりました。申し訳ございませんでした。\u003C\u002Fp\u003E\n\u003Cp\u003E想定解法(一歩手前？)で正答しましたが、完全に不正解です。なんなら今から点数下げてもらっても構わないレベルです……。\nCTF でよかった……………………\u003C\u002Fp\u003E\n\u003Cp\u003Eちゃんとサンドボックスで解凍しましょう！！！！ホストで解凍厳禁！！！！！ホストに生バイナリ出さない！！！！\n肝に命じておきます。\u003C\u002Fp\u003E\n\u003Ch3 id=\"udon\"\u003E\u003Ca href=\"#udon\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003Eudon\u003C\u002Fh3\u003E\n\u003Cp\u003E解けませんでした。\u003C\u002Fp\u003E\n\u003Cp\u003Eひたすらカレーうどんを検索しました。\u003C\u002Fp\u003E\n\u003Cp\u003Eおしまい。\u003C\u002Fp\u003E\n","date":"16 September 2021","timeToRead":2}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/gridsome-blog/assets/js/app.267df36e.js" defer></script><script src="/gridsome-blog/assets/js/page--src--templates--post-vue.c275e0ae.js" defer></script>
  </body>
</html>
